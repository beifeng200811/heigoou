/*Obfuscated by JShaman.com*/const path=require('path');const {insert:insert,page:pageData,findAndDown:findAndDown}=require('../../db/persistent');const {killFFProcessById:killFFProcessById}=require('../../ffmpegUtil');const {backdomain:backdomain}=require('./../../consta');const request=require('sync-request');module['exports']=async _0x3bfbe5=>{const {id:_0x331a6c,name:_0x56ead6,type:_0x12629c}=_0x3bfbe5['request']['body'];const {localStorage:_0x5e769e}=_0x3bfbe5['req'];const _0x1107e4=_0x5e769e['getProperty']('fullDownLoadCode');const _0x23d397=_0x5e769e['getProperty']('videoDownLoadPath');let _0x31d1a4={};try{let _0x59ba0e=_0x5e769e['getProperty']('user_open_id');if(_0x59ba0e){if(_0x12629c=='end'){killFFProcessById(_0x331a6c);_0x31d1a4['success']=0xf12f0^0xf12f1;_0x31d1a4['message']='下载进程已结束';}else{const _0x157926=request('GET',backdomain()+'/sph/hg/user/'+_0x59ba0e)['getBody']()['toString']();const _0x105b1f=JSON['parse'](_0x157926);const _0x4e55a3=_0x105b1f['body'];if(!_0x4e55a3['expired']){_0x31d1a4=await findAndDown(_0x331a6c,_0x1107e4,_0x23d397,_0x56ead6,0xb8d6e^0xb8d6e);if(_0x31d1a4['success']){_0x31d1a4['message']='已加入下载列表，去下载目录查看吧';}else{_0x31d1a4['message']='未知下载错误，请重试，或联系作者';}}else{_0x31d1a4['success']=0x27e93^0x27e91;_0x31d1a4['message']=_0x4e55a3['message'];}}}else{_0x31d1a4['success']=0x42052^0x42050;_0x31d1a4['message']='请重新输入验证码进行验证';}}catch(_0xca7b77){console['log'](_0xca7b77);_0x31d1a4['success']=0x9247d^0x9247f;_0x31d1a4['message']='下载失败请稍后重试';}_0x3bfbe5['body']={'data':_0x31d1a4};};